<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Fundamentals of Functional Connectivity and Gradients | Jongmin Mun</title> <meta name="author" content="Jongmin Mun"> <meta name="description" content="Principle and practice of mapping the brain's functional architecture into a low-dimensional space."> <meta name="keywords" content="Jongmin Mun, USC"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://jong-min-moon.github.io/blog/2023/fc/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Fundamentals of Functional Connectivity and Gradients",
      "description": "Principle and practice of mapping the brain's functional architecture into a low-dimensional space.",
      "published": "February 9, 2023",
      "authors": [
        {
          "author": "Albert Einstein",
          "authorURL": "https://en.wikipedia.org/wiki/Albert_Einstein",
          "affiliations": [
            {
              "name": "IAS, Princeton",
              "url": ""
            }
          ]
        },
        {
          "author": "Boris Podolsky",
          "authorURL": "https://en.wikipedia.org/wiki/Boris_Podolsky",
          "affiliations": [
            {
              "name": "IAS, Princeton",
              "url": ""
            }
          ]
        },
        {
          "author": "Nathan Rosen",
          "authorURL": "https://en.wikipedia.org/wiki/Nathan_Rosen",
          "affiliations": [
            {
              "name": "IAS, Princeton",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Jongmin </span>Mun</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/coursework/">Coursework</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Posts<span class="sr-only">(current)</span></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Fundamentals of Functional Connectivity and Gradients</h1> <p>Principle and practice of mapping the brain's functional architecture into a low-dimensional space.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#i-functional-connectivity">I. Functional Connectivity</a></div> <div><a href="#citations">Citations</a></div> <div><a href="#footnotes">Footnotes</a></div> <div><a href="#code-blocks">Code Blocks</a></div> <div><a href="#interactive-plots">Interactive Plots</a></div> <div><a href="#mermaid">Mermaid</a></div> <div><a href="#diff2html">Diff2Html</a></div> <div><a href="#leaflet">Leaflet</a></div> <div><a href="#chartjs-echarts-and-vega-lite">Chartjs, Echarts and Vega-Lite</a></div> <div><a href="#tikz">TikZ</a></div> <div><a href="#typograms">Typograms</a></div> <div><a href="#layouts">Layouts</a></div> <div><a href="#other-typography">Other Typography?</a></div> </nav> </d-contents> <h2 id="i-functional-connectivity">I. Functional Connectivity</h2> <p>At the level of basic measurements, neuroimaging data can be said to consist typically of a set of signals (usually time series) at each of a collection of pixels (in two dimensions) or voxels (in three dimensions). Building from such data, various forms of higher-level data representations are employed in neuroimaging<d-cite key="ginestetHypothesisTestingNetwork2017"></d-cite>. Since brain regions cooperate within large-scale functional networks to support specific cognitive processes, increasingly in recent years, there has emerged a substantial interest in network-based representations<d-cite key="warnickBayesianApproachEstimating2018"></d-cite>.</p> <p>There are three main types of brain connectivity:</p> <table> <thead> <tr> <th style="text-align: left">Connectivity Type</th> <th style="text-align: left">Description</th> <th style="text-align: left">Modality</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>Functional Connectivity</strong></td> <td style="text-align: left">Investigates the <strong>undirected</strong> statistical dependence between separate brain regions characterized by similar temporal dynamics. It does not imply direct structural connection.</td> <td style="text-align: left">fMRI, EEG, MEG</td> </tr> <tr> <td style="text-align: left"><strong>Effective Connectivity</strong></td> <td style="text-align: left">Refers to the <strong>directed, or causal</strong> influence of one region over another.</td> <td style="text-align: left">fMRI, EEG, MEG, TMS</td> </tr> <tr> <td style="text-align: left"><strong>Structural Connectivity</strong></td> <td style="text-align: left">Investigates the <strong>physical connections</strong> (e.g., axons, white matter) between brain regions.</td> <td style="text-align: left">DTI, sMRI</td> </tr> </tbody> </table> <p>Functional connectivities are inferred when signals from two separate regions fluctuate in synchrony. Basically, computing correlation. Signals can be from any modalities. For example:</p> <ul> <li> <strong>fMRI:</strong> Functional magnetic resonance imaging (fMRI) provides an indirect measure of neuronal activity by evaluating changes in blood oxygenation over different areas of the brain. Good spatial resolution, low temporal resolution.</li> <li> <strong>EEG / MEG:</strong> Measures <strong>electrical/magnetic activity</strong> directly. Excellent temporal resolution, lower spatial resolution.</li> </ul> <h2 id="ii-functional-gradients-low-dimensional-representation">II. Functional Gradients: Low-Dimensional Representation</h2> <h3 id="1-the-high-dimensionality-challenge">1. The High-Dimensionality Challenge</h3> <ul> <li> <strong>The Problem:</strong> Functional connectivity analysis generates a $p \times p$ matrix, where $p$ is the number of brain regions. If $p=400$, each region is defined by a complex 400-dimensional connectivity vector. This high-dimensional space is noisy, difficult to visualize, and computationally expensive to model.</li> <li> <strong>The Solution:</strong> Dimensionality reduction techniques (e.g., PCA, t-SNE, Diffusion Mapping) are applied to extract the “dominant axes” of variance. These axes represent the underlying organizational principles of the brain.</li> </ul> <h3 id="2-what-is-a-gradient">2. What is a “Gradient”?</h3> <p>A <strong>Functional Gradient</strong> is a PC score. It is a continuous coordinate system for the brain. Instead of forcing regions into discrete “clusters”, a gradient places every region along a continuous spectrum based on the similarity of their connectivity profiles.</p> <h3 id="3-why-use-functional-gradients">3. Why use Functional Gradients?</h3> <p>It is low-dimensional but encodes the brain activity sufficiently well. For example, gradients provide a parsimonious representation of the <strong>Cortical Hierarchy</strong>, revealing the transition from sensation to abstraction:</p> <ul> <li> <strong>Efficiency:</strong> They condense complex connectivity patterns into a single, biologically interpretable axis.</li> <li> <strong>The Principal Gradient (Cortical Hierarchy) distinguishes:</strong> <ul> <li> <strong>Anchor 1: Unimodal (Low-Level):</strong> Primary sensory/motor regions (e.g., Visual Cortex) that process immediate external stimuli.</li> <li> <strong>Anchor 2: Transmodal (High-Level):</strong> Association regions (e.g., Default Mode Network) involved in abstract, internal cognition like memory and planning.</li> <li> <strong>Insight:</strong> This gradient captures the fundamental biological principle of how the brain abstracts raw sensory data into high-level thought. <h2 id="iii-data-acquisition-workflow">III. Data Acquisition Workflow</h2> </li> </ul> </li> </ul> <p>This workflow moves beyond simple “Region A connects to Region B” analysis to map the macro-scale hierarchy of the brain.</p> <h3 id="1-workflow-steps">1. Workflow Steps</h3> <ol> <li> <strong>Construct Connectivity Matrix:</strong> <ul> <li> <em>Input:</em> Time-series data for $p$ regions.</li> <li> <em>Operation:</em> Pearson correlation between all pairs.</li> <li> <em>Result:</em> <strong>Symmetric, Dense Matrix</strong>.</li> </ul> </li> <li> <strong>Row-wise Thresholding:</strong> <ul> <li> <em>Operation:</em> For each row, keep only the top 10% strongest connections.</li> <li> <em>Result:</em> <strong>Sparse, Asymmetric Matrix</strong>. (Asymmetry arises because being in A’s top 10% doesn’t guarantee A is in B’s top 10%).</li> <li> <em>Purpose:</em> Filter out noise and weak correlations.</li> </ul> </li> <li> <strong>Affinity Matrix Calculation:</strong> <ul> <li> <em>Operation:</em> Compute <strong>Cosine Similarity</strong> between the sparse rows (connectivity profiles).</li> <li> <em>Question:</em> “Do Region A and Region B have similar ‘friends’ (connectivity patterns)?”</li> <li> <em>Result:</em> <strong>Symmetric Affinity Matrix</strong>. represents <em>contextual similarity</em>, not direct correlation.</li> </ul> </li> <li> <strong>Dimensionality Reduction:</strong> <ul> <li> <em>Operation:</em> Apply <strong>Diffusion Map Embedding</strong>.</li> <li> <em>Result:</em> <strong>Principal Gradients</strong>. Each region gets a coordinate/score along these axes. <h2 id="equations">Equations</h2> </li> </ul> </li> </ol> <p>This theme supports rendering beautiful math in inline and display modes using <a href="https://www.mathjax.org/" rel="external nofollow noopener" target="_blank">MathJax 3</a> engine. You just need to surround your math expression with <code class="language-plaintext highlighter-rouge">$$</code>, like <code class="language-plaintext highlighter-rouge">$$ E = mc^2 $$</code>. If you leave it inside a paragraph, it will produce an inline expression, just like \(E = mc^2\).</p> <p>In fact, you can also use a single dollar sign <code class="language-plaintext highlighter-rouge">$</code> to create inline formulas, such as <code class="language-plaintext highlighter-rouge">$ E = mc^2 $</code>, which will render as $ E = mc^2 $. This approach provides the same effect during TeX-based compilation, but visually it appears slightly less bold compared to double-dollar signs <code class="language-plaintext highlighter-rouge">$$</code>, making it blend more naturally with surrounding text.</p> <p>To use display mode, again surround your expression with <code class="language-plaintext highlighter-rouge">$$</code> and place it as a separate paragraph. Here is an example:</p> \[\left( \sum_{k=1}^n a_k b_k \right)^2 \leq \left( \sum_{k=1}^n a_k^2 \right) \left( \sum_{k=1}^n b_k^2 \right)\] <p>Note that MathJax 3 is <a href="https://docs.mathjax.org/en/latest/upgrading/whats-new-3.0.html" rel="external nofollow noopener" target="_blank">a major re-write of MathJax</a> that brought a significant improvement to the loading and rendering speed, which is now <a href="https://www.intmath.com/cg5/katex-mathjax-comparison.php" rel="external nofollow noopener" target="_blank">on par with KaTeX</a>.</p> <hr> <h2 id="citations">Citations</h2> <p>Citations are then used in the article body with the <code class="language-plaintext highlighter-rouge">&lt;d-cite&gt;</code> tag. The key attribute is a reference to the id provided in the bibliography. The key attribute can take multiple ids, separated by commas.</p> <p>The citation is presented inline like this: (a number that displays more information on hover). If you have an appendix, a bibliography is automatically created and populated in it.</p> <p>Distill chose a numerical inline citation style to improve readability of citation dense articles and because many of the benefits of longer citations are obviated by displaying more information on hover. However, we consider it good style to mention author last names if you discuss something at length and it fits into the flow well — the authors are human and it’s nice for them to have the community associate them with their work.</p> <hr> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2023-02-09-fc.bib"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2026 Jongmin Mun. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>