<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Fundamentals of Continuous Wavelet Transform | Jongmin Mun</title> <meta name="author" content="Jongmin Mun"> <meta name="description" content="Time-frequency decomposition using Analytic and Complex Morlet Wavelets"> <meta name="keywords" content="Jongmin Mun, USC"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://jong-min-moon.github.io/blog/2021/wavelet/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Jongmin </span>Mun</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Posts<span class="sr-only">(current)</span></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Fundamentals of Continuous Wavelet Transform</h1> <p class="post-meta">October 11, 2021</p> <p class="post-tags"> <a href="/blog/2021"> <i class="fas fa-calendar fa-sm"></i> 2021 </a>   ·   <a href="/blog/category/research"> <i class="fas fa-tag fa-sm"></i> research,</a>   <a href="/blog/category/computational"> <i class="fas fa-tag fa-sm"></i> computational</a>   <a href="/blog/category/neuroscience"> <i class="fas fa-tag fa-sm"></i> neuroscience</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h3 id="i-motivation">I. Motivation</h3> <p>For neural signals, the Fourier transform serves primarily as a computational backbone for convolution rather than a final analytical endpoint. Our goal is to uncover not just the frequency content, but the <strong>time-frequency representation</strong> of the signal. Simply put, for a specific frequency band, we want to extract three traces:</p> <ol> <li>the instantaneous power at every time point,</li> <li>the instantaneous phase at every time point,</li> <li>the bandpass-filtered signal.</li> </ol> <p>This is achieved through continuous wavelet transform (CWT). CWT is performed by convolving the signal with a <strong>Morlet Wavelet</strong> defined by a specific frequency.</p> <p>The <strong>Continuous Wavelet Transform (CWT)</strong> is primarily used for <strong>Time-Frequency Representation (TFR)</strong>, for the analysis of traces. In this context, feature extraction means isolating specific time-frequency characteristics. It’s not the ML sense of feature extraction. However, because CWT utilizes a redundant set of basis functions, the extracted features (trace values over time) are highly correlated. This redundancy makes them less suitable as direct features for many machine learning and statistical models. For regression analysis, statisticians typically prefer the <strong>Discrete Wavelet Transform (DWT)</strong>, which uses a discrete set of scales and translations to provide a more parsimonious and orthogonal signal representation. DWT is explained in <a href="https://jong-min.org/blog/2022/DWT/" rel="external nofollow noopener" target="_blank">this post</a>.</p> <p><strong>The Goal:</strong> We need a method for <strong>Time-Frequency Representation (TFR)</strong> that balances temporal and frequency precision.</p> <h3 id="ii-algorithm-overview">II. Algorithm overview</h3> <ul> <li>Input: time series signal, wavelet parameters (frequency, number of cycles)</li> <li>Output: three time series traces (instantaneous power, instantaneous phase, bandpass-filtered signal)</li> <li> <h2 id="computational-backbone-convolution-continuosly-many-inner-products">Computational backbone: Convolution (continuosly many inner products)</h2> </li> </ul> <h3 id="iii-the-morlet-wavelet">III. The Morlet Wavelet</h3> <p>To localize frequency information in time, we must restrict the sine wave so it does not extend infinitely.</p> <h4 id="1-definition">1. Definition</h4> <p>A Morlet wavelet is created by multiplying a <strong>Sine Wave</strong> by a <strong>Gaussian Window</strong> (taper).</p> <ul> <li> <strong>Sine Wave:</strong> Provides the frequency specificity.</li> <li> <strong>Gaussian Window:</strong> Localizes the wave in time and dampens the edges to zero to prevent artifacts.</li> </ul> <h4 id="2-the-gaussian-formula">2. The Gaussian Formula</h4> <p>The shape of the taper is defined by:</p> \[GaussWin(t) = a e^{-(t-m)^2 / (2s^2)}\] <ul> <li>\( a \): Amplitude.</li> <li>\( t \): Time.</li> <li>\( m \): Time offset (usually 0).</li> <li>\( s \): Standard deviation (width) of the Gaussian.</li> </ul> <h4 id="3-the-standard-deviation-s">3. The Standard Deviation (s)</h4> <p>The width of the wavelet \( s \) is determined by the frequency \( f \) and the number of cycles \( n \):</p> \[s = \frac{n}{2\pi f}\] <ul> <li>\( n \): <strong>Number of cycles</strong>. This is the critical user-defined parameter that controls the trade-off between temporal and frequency precision.</li> </ul> <hr> <h3 id="iv-the-limitation-of-real-wavelets">IV. The Limitation of Real Wavelets</h3> <p>A standard “real-valued” Morlet wavelet has a major flaw: the result of convolution depends on the <strong>phase alignment</strong> between the wavelet and the signal.</p> <ul> <li>If the signal and wavelet are phase-aligned (peaks match peaks), the dot product is <strong>positive</strong>.</li> <li>If they are 90° out of phase (peaks match zero-crossings), the dot product is <strong>zero</strong>.</li> <li>If they are 180° out of phase (peaks match troughs), the dot product is <strong>negative</strong>.</li> </ul> <p><strong>Consequence:</strong> You cannot reliably estimate the “power” (energy) of the signal because the value fluctuates based on phase lag, not just signal strength.</p> <hr> <h3 id="v-complex-wavelets--eulers-formula">V. Complex Wavelets &amp; Euler’s Formula</h3> <p>To extract stable estimates of Power and Phase independent of alignment, we use <strong>Complex Morlet Wavelets</strong>.</p> <h4 id="1-complex-sine-waves">1. Complex Sine Waves</h4> <p>Instead of a real sine wave, we use a complex sine wave defined by <strong>Euler’s Formula</strong>:</p> \[e^{i\theta} = \cos(\theta) + i\sin(\theta)\] <p>This creates a “corkscrew” shape that spirals through time in 3 dimensions (Time, Real, Imaginary).</p> <h4 id="2-the-complex-morlet-wavelet-formula">2. The Complex Morlet Wavelet Formula</h4> <p>Combining the Gaussian taper with the complex sine wave:</p> \[cmw(t) = A e^{-t^2 / (2s^2)} e^{i2\pi ft}\] <ul> <li> <strong>Real Part:</strong> \( \cos(2\pi ft) \times \text{Gaussian} \)</li> <li> <strong>Imaginary Part:</strong> \( \sin(2\pi ft) \times \text{Gaussian} \)</li> </ul> <hr> <h3 id="vi-feature-extraction-geometry-of-the-dot-product">VI. Feature Extraction (Geometry of the Dot Product)</h3> <p>When you convolve a Complex Wavelet with neural data, the result at every time point is a <strong>Complex Number</strong>. This number describes a vector in the complex plane.</p> <p>From this single vector, we extract three distinct features:</p> <h4 id="1-bandpass-filtered-signal-real-axis">1. Bandpass Filtered Signal (Real Axis)</h4> <p>The projection of the vector onto the <strong>Real Axis</strong>. This is equivalent to applying a standard bandpass filter with a Gaussian frequency response.</p> <h4 id="2-instantaneous-power-vector-length">2. Instantaneous Power (Vector Length)</h4> <p>The <strong>Squared Magnitude</strong> of the vector. This tells you “how much” of that frequency is present, regardless of phase alignment.</p> <ul> <li> <strong>Formula:</strong> \( \text{Power} = \text{abs}(Z)^2 \) or \( Z \cdot \text{conj}(Z) \)</li> <li> <em>Note:</em> The conjugate method is computationally faster for large matrices.</li> </ul> <h4 id="3-instantaneous-phase-vector-angle">3. Instantaneous Phase (Vector Angle)</h4> <p>The <strong>Angle</strong> of the vector relative to the positive real axis. This tells you the timing of the oscillation.</p> <ul> <li> <strong>Formula:</strong> \( \theta = \text{angle}(Z) = \arctan(\text{imag} / \text{real}) \)</li> </ul> <hr> <h3 id="vii-the-uncertainty-principle-parameter--n-">VII. The Uncertainty Principle (Parameter ( n ))</h3> <p>The number of cycles \( n \) defines the width of the Gaussian taper. This parameter is governed by the Heisenberg uncertainty principle for time-frequency analysis: <strong>You cannot maximize both temporal and frequency precision simultaneously.</strong></p> <table> <thead> <tr> <th style="text-align: left">Cycles (( n ))</th> <th style="text-align: left">Gaussian Width</th> <th style="text-align: left">Temporal Precision</th> <th style="text-align: left">Frequency Precision</th> <th style="text-align: left">Best For…</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>Low (e.g., 3)</strong></td> <td style="text-align: left">Narrow</td> <td style="text-align: left"> <strong>High</strong> (Sharp timing)</td> <td style="text-align: left">Low (Broad spectrum)</td> <td style="text-align: left">Transient bursts / ERPs</td> </tr> <tr> <td style="text-align: left"><strong>High (e.g., 10)</strong></td> <td style="text-align: left">Wide</td> <td style="text-align: left">Low (Blurred timing)</td> <td style="text-align: left"> <strong>High</strong> (Sharp spectrum)</td> <td style="text-align: left">Sustained oscillations</td> </tr> </tbody> </table> <h4 id="variable-cycles">Variable Cycles</h4> <p>It is common to use <strong>variable cycles</strong> (e.g., increasing from 3 to 10 as frequency increases). This adjusts the precision balance across the spectrum:</p> <ul> <li>Allows for better time precision at low frequencies.</li> <li>Allows for better frequency precision at high frequencies.</li> </ul> <p><strong>Source:</strong> Cohen, M. X. <em>Analyzing Neural Time Series Data: Theory and Practice</em>. The MIT Press, 2014. (Chapters 12 &amp; 13).</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/bands/">Fundamentals of Neural Signal Decomposition</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/DWT/">Wavelet Basis &amp; Function Spaces: Besov vs. Hölder</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/maze/">Maze</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/hilbert/">Fundamentals of the Filter-Hilbert Method</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2021/fourier/">Fundamentals of Fourier Transform</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2026 Jongmin Mun. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js"></script> <script defer src="/assets/js/common.js"></script> <script defer src="/assets/js/copy_code.js" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>