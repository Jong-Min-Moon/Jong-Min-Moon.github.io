<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Bayesian Spatial Modeling of Cancer Incidence (BYM2 Model) | Jongmin Mun</title> <meta name="author" content="Jongmin Mun"> <meta name="description" content="a project with a background image"> <meta name="keywords" content="Jongmin Mun, USC"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://jong-min-moon.github.io/projects/5_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Jongmin </span>Mun</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">working papers</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Bayesian Spatial Modeling of Cancer Incidence (BYM2 Model)</h1> <p class="post-description">a project with a background image</p> </header> <article> <h2 id="part-1-theoretical-framework">Part 1: Theoretical Framework</h2> <p>This analysis employs a <strong>Generalized Linear Model (GLM)</strong> framework with <strong>Bayesian Hierarchical Spatial Random Effects</strong> using a <strong>Conditional Autoregressive Normal Prior (CAR Normal)</strong>. This approach enables us to model disease relative risk while incorporating local risk factors, such as pollution and socio-economic status, as well as accounting for the spatial dependencies inherent in geographic data.</p> <h3 id="1-the-generalized-linear-model-glm">1. The Generalized Linear Model (GLM)</h3> <p>GLM assumes the distribution of the response variable belongs to an <strong>exponential family</strong>, a collection of distributions with a specific density form, characterized by cumulant generating function.</p> <ul> <li> <strong>Likelihood (Poisson Regression):</strong> Since we are modeling the count of cancer incidence in each area , we model as a Poisson distribution: \(Y_i \sim \text{Poisson}(\lambda_i)\)</li> </ul> <p>where is the expected count of cases in area .</p> <ul> <li> <strong>Link Function:</strong> The GLM models the relationship between the expected value and the linear predictors using a <strong>link function</strong>. For Poisson regression, we use the <strong>log link</strong>: \(\log(\lambda_i) = \eta_i\)</li> </ul> <p>This is often called a “log-linear model.” The exponentiated coefficients ($e^\beta$) represent the multiplicative change in the expected count for a one-unit increase in the predictor.</p> <h3 id="2-the-offset-variable">2. The Offset Variable</h3> <p>To model the cancer <strong>rate</strong> (risk) rather than the raw count, we introduce an <strong>offset term</strong>, (Expected Cases). \(\log(\lambda_i) = \log(E_i) + \alpha + \mathbf{X}_i\boldsymbol{\beta} + \psi_i\)</p> <ul> <li> <strong>Role of Offset:</strong> represents the known “background” population size or age-adjusted expected count. It is added as a constant (coefficient fixed at 1) to the linear predictor.</li> <li> <strong>Assumption:</strong> Using an offset implies that doubling the population size leads to a doubling of the count outcome.</li> <li> <strong>Interpretation:</strong> The exponentiated regression coefficients now describe how predictors modify the <strong>relative risk</strong> compared to the expected background rate.</li> </ul> <h3 id="3-spatial-random-effects-the-bym-model">3. Spatial Random Effects (The BYM Model)</h3> <p>Random effects or hierarchical models model correlations across units. They arise in linear modeling to avoid <strong>pseudo-replication</strong>: the error of treating units that are non-IID (independent and identically distributed) as if they were IID. Units often have a hierarchically clustered structure, such as students belonging to classes, schools, and districts. Students in the same class are distinct entities, but they share common environmental factors, so they are not fully independent. Another example is spatial correlation: adjacent states, such as California and Oregon, are distinct entities but share common geographical features, meaning they are not truly IID.</p> <p>Hierarchical models address this by assigning regression coefficients (random effects) to the indicator variables for this correlation structure (e.g., the specific group or region). Crucially, these coefficients share the same nontrivial hyperparameter (e.g. variance). This shared distribution allows the model to <strong>borrow strength</strong> within groups. Estimates for groups with sparse data are stabilized by being pulled toward the group mean, effectively using information from the wider population to improve unit inference with small data.</p> <p>Through this mechanism, the model achieves <strong>partial pooling</strong>. It is a good compromise between two extremes:</p> <ul> <li> <strong>no pooling</strong>: assuming independece and non-identity across units, just include indicator variables as predictors, without hieararchical structure. This corresponds to setting the variance of prior as \(\infty\).</li> <li> <strong>complete pooling</strong>: assuming iid across units. Not inclduing indicator variables as predictors. This corresponds to setting the variance of effects as zero.</li> </ul> <p>Geographical data is rarely independent; high-cancer areas tend to cluster. To capture this <strong>spatial dependence</strong>, we introduce a random effect term into the linear predictor. In the <strong>Besag-York-Mollié (BYM)</strong> framework, this random effect is split into two components:</p> \[\psi_i = \underbrace{u_i}_{\text{Spatial (Structured)}} + \underbrace{v_i}_{\text{Noise (Unstructured)}}\] <h4 id="the-spatial-component-u_i">The Spatial Component ($u_i$)</h4> <p>The spatial component is modeled using a <strong>Conditional Autoregressive (CAR)</strong> prior. This allows each area to “borrow strength” from its neighbors.</p> <ul> <li><strong>Conditional Specification:</strong></li> </ul> \[u_i \mid \mathbf{u}_{-i}\sim \mathcal{N} \left( \frac{\sum_{j \in \text{ne}(i)} u_j}{n_i}, \frac{\tau^2}{n_i} \right)\] <ul> <li> <strong>Mean:</strong> The conditional expectation of an area’s risk is the average of its neighbors’ risks.</li> <li> <strong>Variance:</strong> Variance is inversely proportional to the number of neighbors (). Areas with more neighbors have lower variance (more information).</li> <li> <strong>Precision Matrix:</strong> The joint distribution is an improper multivariate normal where the precision matrix corresponds to the <strong>Graph Laplacian</strong>. This structure shrinks the random effect of sparse regions toward the local mean, stabilizing inference.</li> </ul> <h2 id="part-2-code-implementation-explanation">Part 2: Code Implementation Explanation</h2> <p>The implementation is split into a Python script (data processing &amp; interface) and a Stan file (statistical model).</p> <h3 id="block-1-helper-functions--setup">Block 1: Helper Functions &amp; Setup</h3> <p>We define helper functions to handle legacy data formats (Microsoft Access <code class="language-plaintext highlighter-rouge">.mdb</code>) and standard settings.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read_mdb_table</span><span class="p">(</span><span class="n">db_path</span><span class="p">,</span> <span class="n">table_name</span><span class="p">):</span>
    <span class="c1"># ... uses 'mdb-export' to convert Access tables to CSV ...
</span>
</code></pre></div></div> <p><strong>Explanation:</strong> This function acts as a bridge. Since Python cannot natively read older <code class="language-plaintext highlighter-rouge">.mdb</code> files on Linux/Colab, this function calls a system command (<code class="language-plaintext highlighter-rouge">mdb-export</code>) to extract the requested table into a CSV format in memory, which <code class="language-plaintext highlighter-rouge">pandas</code> can then read.</p> <h3 id="block-2-data-loading--geometry-load_and_prep_main_data">Block 2: Data Loading &amp; Geometry (<code class="language-plaintext highlighter-rouge">load_and_prep_main_data</code>)</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">load_and_prep_main_data</span><span class="p">():</span>
    <span class="n">ses_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="p">.</span><span class="nf">read_file</span><span class="p">(</span><span class="sh">"</span><span class="s">.../NYS_SES_Data_region.shp</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">cancer_gdf</span> <span class="o">=</span> <span class="n">gpd</span><span class="p">.</span><span class="nf">read_file</span><span class="p">(</span><span class="sh">"</span><span class="s">.../NYSCancer_region.shp</span><span class="sh">"</span><span class="p">)</span>
    <span class="c1"># ... casting IDs to string ...
</span>    <span class="n">gdf</span> <span class="o">=</span> <span class="n">cancer_gdf</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">ses_gdf</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">DOHREGION</span><span class="sh">'</span><span class="p">,</span> <span class="p">...)</span>

</code></pre></div></div> <p><strong>Explanation:</strong></p> <ol> <li> <strong>Shapefiles:</strong> Loads the Cancer geometry and Socioeconomic (SES) data.</li> <li> <strong>String Casting:</strong> Critical step. It converts <code class="language-plaintext highlighter-rouge">DOHREGION</code> to a string to ensure that IDs like <code class="language-plaintext highlighter-rouge">"05"</code> don’t become integer <code class="language-plaintext highlighter-rouge">5</code>, which would break the merge.</li> <li> <strong>Merge:</strong> Combines the two datasets into a single GeoDataFrame (<code class="language-plaintext highlighter-rouge">gdf</code>).</li> </ol> <h3 id="block-3-processing-divorce-data-process_divorce_data">Block 3: Processing Divorce Data (<code class="language-plaintext highlighter-rouge">process_divorce_data</code>)</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">process_divorce_data</span><span class="p">(</span><span class="n">crosswalk_gdf</span><span class="p">):</span>
    <span class="n">df_tracts</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="sh">"</span><span class="s">.../NY_Tract_Divorce.csv</span><span class="sh">"</span><span class="p">)</span>
    <span class="c1"># ... crosswalk logic ...
</span>    <span class="n">merged_bg</span> <span class="o">=</span> <span class="n">crosswalk_prep</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">df_tracts</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="sh">'</span><span class="s">TRACT_GEOID</span><span class="sh">'</span><span class="p">,</span> <span class="p">...)</span>
    <span class="n">divorce_agg</span> <span class="o">=</span> <span class="n">merged_bg</span><span class="p">.</span><span class="nf">groupby</span><span class="p">(</span><span class="sh">'</span><span class="s">DOHREGION</span><span class="sh">'</span><span class="p">).</span><span class="nf">mean</span><span class="p">()</span>

</code></pre></div></div> <p><strong>Explanation:</strong> This block handles the <strong>spatial mismatch</strong> between the available divorce data (Census Tracts) and the model units (Cancer Regions).</p> <ol> <li> <strong>Crosswalk:</strong> Uses a lookup table to map standard Census IDs (<code class="language-plaintext highlighter-rouge">TRACT_GEOID</code>) to custom Cancer Region IDs (<code class="language-plaintext highlighter-rouge">DOHREGION</code>).</li> <li> <strong>Imputation:</strong> Assigns the divorce rate of a Tract to all Block Groups inside it.</li> <li> <strong>Aggregation:</strong> Averages the divorce rates of all block groups within a specific <code class="language-plaintext highlighter-rouge">DOHREGION</code> to create a single predictor value for that region.</li> </ol> <h3 id="block-4-processing-pollution-data-process_pollution_data">Block 4: Processing Pollution Data (<code class="language-plaintext highlighter-rouge">process_pollution_data</code>)</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">process_pollution_data</span><span class="p">(</span><span class="n">crosswalk_gdf</span><span class="p">):</span>
    <span class="n">df_nata</span> <span class="o">=</span> <span class="nf">read_mdb_table</span><span class="p">(...,</span> <span class="sh">'</span><span class="s">US_NATA05_srcrisk...</span><span class="sh">'</span><span class="p">)</span>
    <span class="c1"># ... filter for NY (FIPS 36) ...
</span>    <span class="n">df_nata</span><span class="p">[</span><span class="sh">'</span><span class="s">Cancer_Risk</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_nata</span><span class="p">[</span><span class="n">risk_cols</span><span class="p">].</span><span class="nf">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># ... merge and aggregate ...
</span>
</code></pre></div></div> <p><strong>Explanation:</strong></p> <ol> <li> <strong>Extraction:</strong> Pulls the “Cancer Risk” table from the EPA NATA 2005 database.</li> <li> <strong>Summation:</strong> Calculates <code class="language-plaintext highlighter-rouge">Total Cancer Risk</code> by summing components (Point source + On-road + Non-road + Background). This creates a cumulative risk score.</li> <li> <strong>Aggregation:</strong> Similar to the divorce block, it maps these Tract-level risk scores to the custom Cancer Regions using the crosswalk.</li> </ol> <h3 id="block-5-feature-engineering--graph-construction">Block 5: Feature Engineering &amp; Graph Construction</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create Predictors
</span><span class="n">gdf</span><span class="p">[</span><span class="sh">'</span><span class="s">poverty_rate</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="sh">'</span><span class="s">POVUNDER</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">gdf</span><span class="p">[</span><span class="sh">'</span><span class="s">POVUNDER</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="n">gdf</span><span class="p">[</span><span class="sh">'</span><span class="s">POVOVER</span><span class="sh">'</span><span class="p">])</span>
<span class="c1"># ... log transforms ...
</span>
<span class="c1"># Build Graph
</span><span class="n">w</span> <span class="o">=</span> <span class="n">libpysal</span><span class="p">.</span><span class="n">weights</span><span class="p">.</span><span class="n">Queen</span><span class="p">.</span><span class="nf">from_dataframe</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>
<span class="c1"># ... Scaling Factor Calculation ...
</span><span class="n">scaling_factor</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">diag_inv</span><span class="p">)))</span>

</code></pre></div></div> <p><strong>Explanation:</strong></p> <ol> <li> <strong>Rates:</strong> Converts raw counts (e.g., “Population in Poverty”) into rates (percentage) to make them comparable across regions.</li> <li> <strong>Log Transform:</strong> Applied to the Pollution Risk variable because such data is usually highly skewed (a few areas have massive pollution). The log scale linearizes the relationship.</li> <li> <strong>Adjacency Graph:</strong> Uses <code class="language-plaintext highlighter-rouge">libpysal</code> to define who is a “neighbor” (sharing a boundary).</li> <li> <strong>Scaling Factor:</strong> This is unique to <strong>BYM2</strong>. It calculates a geometric scaling factor from the graph Laplacian. This ensures that the variance parameter has the same interpretation regardless of the graph structure (e.g., whether the map is of New York or Texas).</li> </ol> <h3 id="block-6-the-stan-model-bym2_modelstan">Block 6: The Stan Model (<code class="language-plaintext highlighter-rouge">bym2_model.stan</code>)</h3> <div class="language-stan highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nn">model</span> <span class="p">{</span>
  <span class="c1">// Priors</span>
  <span class="kr">target</span> <span class="o">+=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="nb">dot_self</span><span class="p">(</span><span class="nv">phi</span><span class="p">[</span><span class="nv">node1</span><span class="p">]</span> <span class="o">-</span> <span class="nv">phi</span><span class="p">[</span><span class="nv">node2</span><span class="p">]);</span> <span class="c1">// The CAR prior</span>
  <span class="nb">sum</span><span class="p">(</span><span class="nv">phi</span><span class="p">)</span> <span class="o">~</span> <span class="nb">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="nv">N</span><span class="p">);</span> <span class="c1">// Soft sum-to-zero constraint</span>
  
  <span class="c1">// Likelihood (GLM)</span>
  <span class="nv">Y</span> <span class="o">~</span> <span class="nb">poisson_log</span><span class="p">(</span><span class="nv">log_offset</span> <span class="o">+</span> <span class="nv">alpha</span> <span class="o">+</span> <span class="nv">X</span> <span class="o">*</span> <span class="nv">beta</span> <span class="o">+</span> <span class="nv">convolved_re</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div></div> <p><strong>Explanation:</strong></p> <ol> <li> <strong><code class="language-plaintext highlighter-rouge">target += ...</code></strong>: This line implements the <strong>ICAR (Intrinsic Conditional Autoregressive)</strong> prior. It penalizes differences between neighbors (<code class="language-plaintext highlighter-rouge">phi[node1] - phi[node2]</code>), forcing the spatial random effects to be smooth.</li> <li> <strong><code class="language-plaintext highlighter-rouge">sum(phi) ~ ...</code></strong>: A constraint to ensure the spatial effects sum to zero. This is necessary for the model to be identifiable (otherwise the intercept <code class="language-plaintext highlighter-rouge">alpha</code> and the random effects <code class="language-plaintext highlighter-rouge">phi</code> would be confounded).</li> <li> <strong><code class="language-plaintext highlighter-rouge">poisson_log</code></strong>: The likelihood function described in Part 1. It links the observed counts to the linear predictor via the log function.</li> </ol> <h3 id="block-7-inference">Block 7: Inference</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span> <span class="o">=</span> <span class="nc">CmdStanModel</span><span class="p">(</span><span class="n">stan_file</span><span class="o">=</span><span class="sh">'</span><span class="s">bym2_model.stan</span><span class="sh">'</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">sample</span><span class="p">(...)</span>
<span class="n">summary</span> <span class="o">=</span> <span class="n">fit</span><span class="p">.</span><span class="nf">summary</span><span class="p">()</span>

</code></pre></div></div> <p><strong>Explanation:</strong></p> <ol> <li> <strong>Sampling:</strong> Runs the Hamiltonian Monte Carlo (HCMC) algorithm to sample from the posterior distribution.</li> <li> <strong>Results:</strong> Extracts the <code class="language-plaintext highlighter-rouge">beta</code> coefficients. <ul> <li>If <code class="language-plaintext highlighter-rouge">beta</code> for Pollution is positive and its Credible Interval excludes zero, we conclude that higher pollution is associated with significantly higher cancer risk, even after controlling for poverty and spatial clustering. Here is a structured summary of the challenges we navigated during this project.</li> </ul> </li> </ol> <h3 id="1-data-engineering-challenges-the-messy-real-world-data-story">1. Data Engineering Challenges (The “Messy Real-World Data” Story)</h3> <p><strong>Challenge: Integrating Mismatched Spatial Granularities ( The “Crosswalk” Problem)</strong></p> <ul> <li> <strong>The Situation:</strong> Our outcome variable (Cancer Incidence) was aggregated to custom “DOH Regions” (clusters of block groups) to protect patient privacy. However, our predictor variables came from disparate government sources at different levels: Census Tracts (Divorce, NATA Pollution) and Block Groups (SES).</li> <li> <strong>The Action:</strong> I built a custom <strong>Spatial Crosswalk Pipeline</strong>.</li> <li>I loaded a definition file linking Block Groups to Cancer Regions.</li> <li> <p>I engineered a “down-scale and re-aggregate” logic: Data at the Tract level was broadcast down to constituent Block Groups, then re-aggregated (averaged) up to the custom Cancer Region level.</p> </li> <li> <strong>The Result:</strong> Successfully merged three disparate datasets into a single analytical dataframe without losing spatial fidelity.</li> </ul> <p><strong>Challenge: Accessing Legacy Infrastructure (The “.mdb” Problem)</strong></p> <ul> <li> <strong>The Situation:</strong> The specific pollution data required for the study period (2005 NATA) was only available in an archived Microsoft Access Database (<code class="language-plaintext highlighter-rouge">.mdb</code>) format, which is not natively supported in modern Linux/Python CI/CD environments (like Colab).</li> <li> <strong>The Action:</strong> I implemented a workaround using the <code class="language-plaintext highlighter-rouge">mdbtools</code> system utility.</li> <li> <p>I wrote a Python wrapper function that subprocessed shell commands to extract specific tables from the proprietary database into memory as CSVs, bypassing the need for a Windows environment.</p> </li> <li> <strong>The Result:</strong> Automated the extraction of 2005-era pollution risk data, enabling the inclusion of a critical environmental predictor that would have otherwise been inaccessible.</li> </ul> <p><strong>Challenge: Handling Missing and Zero-Inflated Data (The “NaN” Crash)</strong></p> <ul> <li> <strong>The Situation:</strong> The Stan MCMC engine kept crashing with <code class="language-plaintext highlighter-rouge">Log probability is NaN</code>.</li> <li> <strong>The Action:</strong> I diagnosed two root causes:</li> <li> <strong>Division by Zero:</strong> Some areas had 0 population, causing <code class="language-plaintext highlighter-rouge">Count / Pop</code> calculations to explode to Infinity.</li> <li> <strong>Log(0):</strong> Calculating <code class="language-plaintext highlighter-rouge">log(Expected_Cases)</code> for areas with 0 expected cases resulted in <code class="language-plaintext highlighter-rouge">-Infinity</code>.</li> <li>I implemented a robust <strong>Data Cleaning &amp; Imputation Step</strong> prior to modeling, replacing infinities with NaNs, imputing missing values with column means, and filtering out invalid rows.</li> </ul> <hr> <h3 id="2-statistical-modeling-challenges-the-rigorous-science-story">2. Statistical Modeling Challenges (The “Rigorous Science” Story)</h3> <p><strong>Challenge: Accounting for Spatial Autocorrelation (Why Standard Regression Failed)</strong></p> <ul> <li> <strong>The Situation:</strong> A standard Poisson regression assumes that cancer rates in one neighborhood are independent of its neighbors. In reality, environmental risks and demographics cluster spatially.</li> <li> <strong>The Action:</strong> I implemented a <strong>BYM2 (Besag-York-Mollié)</strong> Bayesian hierarchical model.</li> <li>This separates the error term into two components: an <strong>Unstructured Random Effect</strong> (pure noise) and a <strong>Structured Spatial Effect</strong> (where is conditional on neighbors).</li> <li>I used an <strong>ICAR (Intrinsic Conditional Autoregressive)</strong> prior to allow regions to “borrow strength” from their neighbors, smoothing the estimates in low-population areas.</li> </ul> <p><strong>Challenge: Graph Connectivity (The “Island” Problem)</strong></p> <ul> <li> <strong>The Situation:</strong> The spatial graph (adjacency matrix) contained “islands”—regions with no neighbors. This makes the ICAR prior mathematically impossible (division by zero neighbors).</li> <li> <strong>The Action:</strong> I used <code class="language-plaintext highlighter-rouge">libpysal</code> to detect disconnected components in the graph and filtered them out before passing the adjacency matrix to the Bayesian sampler.</li> </ul> <hr> <p><strong>Challenge: MCMC Convergence Speed (Hours vs. Minutes)</strong></p> <ul> <li> <strong>The Situation:</strong> Running a full Hamiltonian Monte Carlo (HCMC) sampling on 13,000 regions with complex spatial priors was taking hours and exceeding available compute resources.</li> <li> <strong>The Action:</strong> I applied a two-tiered optimization strategy: <ol> <li> <strong>Algorithmic:</strong> I rewrote the Stan model to use <code class="language-plaintext highlighter-rouge">poisson_log_glm</code>, which uses AVX-optimized matrix algebra for the likelihood function (10x speedup).</li> <li> <strong>Strategic:</strong> I implemented a filtering mechanism to subset the data by County (e.g., focusing on FIPS 061/Manhattan) to validate the model pipeline on ~300 regions before attempting a full-state run.</li> </ol> </li> </ul> <p>Every project has a beautiful feature showcase page. It’s easy to include images in a flexible 3-column grid format. Make your photos 1/3, 2/3, or full width.</p> <p>To give your project a background in the portfolio page, just add the img tag to the front matter like so:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---
layout: page
title: project
description: a project with a background image
img: /assets/img/12.jpg
---
</code></pre></div></div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/1-1400.webp"></source> <img src="/assets/img/1.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/3-1400.webp"></source> <img src="/assets/img/3.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/5-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/5-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/5-1400.webp"></source> <img src="/assets/img/5.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Caption photos easily. On the left, a road goes through a tunnel. Middle, leaves artistically fall in a hipster photoshoot. Right, in another hipster photoshoot, a lumberjack grasps a handful of pine needles. </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/5-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/5-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/5-1400.webp"></source> <img src="/assets/img/5.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> This image can also have a caption. It's like magic. </div> <p>You can also put regular text between your rows of images. Say you wanted to write a little bit about your project before you posted the rest of the images. You describe how you toiled, sweated, <em>bled</em> for your project, and then… you reveal its glory in the next row of images.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/6-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/6-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/6-1400.webp"></source> <img src="/assets/img/6.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-4 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/11-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/11-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/11-1400.webp"></source> <img src="/assets/img/11.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> You can also have artistically styled 2/3 + 1/3 images, like these. </div> <p>The code is simple. Just wrap your images with <code class="language-plaintext highlighter-rouge">&lt;div class="col-sm"&gt;</code> and place them inside <code class="language-plaintext highlighter-rouge">&lt;div class="row"&gt;</code> (read more about the <a href="https://getbootstrap.com/docs/4.4/layout/grid/" rel="external nofollow noopener" target="_blank">Bootstrap Grid</a> system). To make images responsive, add <code class="language-plaintext highlighter-rouge">img-fluid</code> class to each; for rounded corners and shadows use <code class="language-plaintext highlighter-rouge">rounded</code> and <code class="language-plaintext highlighter-rouge">z-depth-1</code> classes. Here’s the code for the last row of images above:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row justify-content-sm-center"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-8 mt-3 mt-md-0"</span><span class="nt">&gt;</span>
        {% include figure.html path="assets/img/6.jpg" title="example image" class="img-fluid rounded z-depth-1" %}
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-sm-4 mt-3 mt-md-0"</span><span class="nt">&gt;</span>
        {% include figure.html path="assets/img/11.jpg" title="example image" class="img-fluid rounded z-depth-1" %}
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2026 Jongmin Mun. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js"></script> <script defer src="/assets/js/common.js"></script> <script defer src="/assets/js/copy_code.js" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>