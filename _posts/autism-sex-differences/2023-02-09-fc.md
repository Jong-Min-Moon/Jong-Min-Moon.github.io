---
layout: distill
title: Fundamentals of Functional Connectivity and Gradients
description: Principle and practice of mapping the brain's functional architecture into a low-dimensional space.
tags: distill formatting
categories: research
date: 2023-02-09
featured: false
mermaid:
  enabled: true
  zoomable: true
code_diff: true
map: true
chart:
  chartjs: true
  echarts: true
  vega_lite: true
tikzjax: true
typograms: true
project: autism-sex-differences
authors:
  - name: Jongmin Mun
    url: "https://jongminmoon.github.io"


bibliography: 2023-02-09-fc.bib

# Optionally, you can add a table of contents to your post.
# NOTES:
#   - make sure that TOC names match the actual section names
#     for hyperlinks within the post to work correctly.
#   - we may want to automate TOC generation in the future using
#     jekyll-toc plugin (https://github.com/toshimaru/jekyll-toc).
toc:
  - name: I. Functional Connectivity
    # if a section has subsections, you can add them as follows:
    # subsections:
    #   - name: Example Child Subsection 1
    #   - name: Example Child Subsection 2
  - name: "II. Functional Gradients: Low-Dimensional Representation"
    subsections:
      - name: The Curse of Dimensionality 
      - name: Why called "Gradient"?
      - name: Why use Functional Gradients?
  - name: III. Data Acquisition Workflow


# Below is an example of injecting additional post-specific styles.
# If you use this post as a template, delete this _styles block.
_styles: >
  .fake-img {
    background: #bbb;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 0px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 12px;
  }
  .fake-img p {
    font-family: monospace;
    color: white;
    text-align: left;
    margin: 12px 0;
    text-align: center;
    font-size: 16px;
  }
 


---
## I. Functional Connectivity
At the level of basic measurements, neuroimaging data can be said to consist typically of a set of signals (usually time series) at each of a collection of pixels (in two dimensions) or voxels (in three dimensions). Building from such data, various forms of higher-level data representations are employed in neuroimaging<d-cite key="ginestetHypothesisTestingNetwork2017"></d-cite>. Since brain regions cooperate within large-scale functional networks to support specific cognitive processes, increasingly in recent years, there has emerged a substantial interest in network-based representations<d-cite key="warnickBayesianApproachEstimating2018"></d-cite>.

There are three main types of brain connectivity:

| Connectivity Type | Description | Modality |
| :--- | :--- | :--- |
| **Functional Connectivity** | Investigates the **undirected** statistical dependence between separate brain regions characterized by similar temporal dynamics. It does not imply direct structural connection. | fMRI, EEG, MEG
| **Effective Connectivity** | Refers to the **directed, or causal** influence of one region over another. | fMRI, EEG, MEG, TMS
| **Structural Connectivity** | Investigates the **physical connections** (e.g., axons, white matter) between brain regions. | DTI, sMRI

Functional connectivities are inferred when signals from two separate regions fluctuate in synchrony. Basically, computing correlation. Signals can be from any modalities. For example:
*   **fMRI:** Functional magnetic resonance imaging (fMRI) provides an indirect measure of neuronal activity by evaluating changes in blood oxygenation over different areas of the brain. Good spatial resolution, low temporal resolution.
*   **EEG / MEG:** Measures **electrical/magnetic activity** directly. Excellent temporal resolution, lower spatial resolution.

 
 

## II. Functional Gradients: Low-Dimensional Representation

### 1. The Curse of Dimensionality 
*   **The Problem:** Functional connectivity analysis generates a $p \times p$ matrix, where $p$ is the number of brain regions. If $p=400$, each region is defined by a complex 400-dimensional connectivity vector. This high-dimensional space is noisy, difficult to visualize, and computationally expensive to model.
*   **The Solution:** Dimensionality reduction techniques (e.g., PCA, t-SNE, Diffusion Mapping) are applied to extract the "dominant axes" of variance. These axes represent the underlying organizational principles of the brain.

### 2. Why called "Gradient"?
A **Functional Gradient** is analogous to a Principal Component (PC) score, serving as a continuous coordinate system for the brain. Rather than categorizing regions into discrete clusters, a gradient positions each region along a continuous spectrum determined by the similarity of its connectivity profile.

### 3. Why use Functional Gradients?
It is low-dimensional but encodes the brain activity sufficiently well. For example, gradients is shown to distinguish between primary sensory/motor regions (e.g., Visual Cortex) that process immediate external stimuli and association regions (e.g., Default Mode Network) involved in abstract, internal cognition like memory and planning. 

## III. Data Acquisition Workflow 

This workflow moves beyond simple "Region A connects to Region B" analysis to map the macro-scale hierarchy of the brain.

 
1.  **Construct Connectivity Matrix:**
    *   *Input:* Time-series data for $p$ regions.
    *   *Operation:* Pearson correlation between all pairs.
    *   *Result:* **Symmetric, Dense Matrix**.
2.  **Row-wise Thresholding:**
    *   *Operation:* For each row, keep only the top 10% strongest connections.
    *   *Result:* **Sparse, Asymmetric Matrix**. (Asymmetry arises because being in A's top 10% doesn't guarantee A is in B's top 10%).
    *   *Purpose:* Filter out noise and weak correlations.
3.  **Affinity Matrix Calculation:**
    *   *Operation:* Compute **Cosine Similarity** between the sparse rows (connectivity profiles).
    *   *Question:* "Do Region A and Region B have similar 'friends' (connectivity patterns)?"
    *   *Result:* **Symmetric Affinity Matrix**. represents *contextual similarity*, not direct correlation.
4.  **Dimensionality Reduction:**
    *   *Operation:* Apply **Diffusion Map Embedding**.
    *   *Result:* **Principal Gradients**. Each region gets a coordinate/score along these axes.